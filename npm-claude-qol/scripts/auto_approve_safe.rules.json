{
  "_doc_allow": "Groups: system info, file reading, version checks, git, node/npm/yarn/pnpm, python, rust/go, search/text tools, network (read-only + localhost), filesystem, github CLI, process management, background tasks, CLI tools (vercel/drizzle/next), image inspection, non-recursive rm",
  "_doc_deny": "Blocks: privilege escalation, destructive rm, system modification, fork bombs, pipe-to-shell, mass kill, xargs rm, netcat, crontab",
  "_doc_sensitive": "Protects: env files, crypto keys, SSH, cloud credentials, package registry configs, secrets/tokens, Docker/K8s configs",

  "allow_patterns": [
    "^(pwd|whoami|date)$",
    "^uname(\\s+-a)?$",
    "^which\\s+\\S+$",
    "^echo\\s+[^|;&]+$",

    "^(cat|head|tail|wc|less|file|stat|du|df)\\s+[^|;&]+$",
    "^ls(\\s+.*)?$",
    "^tree(\\s+.*)?$",

    "^(python(3)?|node|npm|pnpm|yarn|uv)\\s+--version$",

    "^git\\s+-C\\s+[^|;&]+\\s+(status|diff|log|show|branch|add|commit|checkout|fetch|pull|push)(\\s+.*)?$",
    "^git\\s+(status|diff|log|show|branch|remote|add|commit|checkout|fetch|pull|push|worktree|merge|rebase|tag|switch|restore|rev-parse|ls-files|check-ignore|update-index|stash\\s+(list|push|pop|drop|apply))(\\s+.*)?$",
    "^git\\s+rm\\s+[^|;&]+$",
    "^git\\s+rev-list\\s+[^|;&]+$",
    "^git\\s+ls-tree\\s+[^|;&]+\\s*\\|\\s*(grep|head|tail|wc)[^|;&]*$",
    "^git\\s+commit\\s+-m\\s+\"\\$\\(cat\\s+<<'?EOF'?",
    "^git\\s+stash(\\s+--include-untracked|\\s+--all|\\s+-u|\\s+-a)?(\\s+-m\\s+.*)?$",

    "^pnpm\\s+(test|run\\s+(test|lint|typecheck|type-check|check|build|dev|start)|install|i|add|remove)(\\s+.*)?$",
    "^npm\\s+(test|install|i|ci)(\\s+.*)?$",
    "^npm\\s+run\\s+[\\w:-]+(\\s+[^|;&]*)?(\\s*2>&1)?(\\s*&)?$",
    "^npm\\s+whoami$",
    "^npm\\s+list(\\s+(-g|--global))?(\\s+[\\w@/-]+)?$",
    "^npm\\s+ls(\\s+[\\w@/-]+)*$",
    "^npm\\s+view\\s+[\\w@/-]+(\\s+.*)?$",
    "^npm\\s+pack\\s+[\\w@/-]+\\s+--dry-run",
    "^npm\\s+(info|show)\\s+[@\\w/-]+(\\s+[\\w.]+)?(\\s+2>&1)?$",
    "^npm\\s+config\\s+(get|list)(\\s+[\\w.-]+)?(\\s+2>/dev/null)?$",
    "^yarn\\s+(test|lint|typecheck|type-check|check|build|dev|start|install|add|remove)(\\s+.*)?$",
    "^npx\\s+(tsc|eslint|prettier|vitest|jest)(\\s+.*)?$",
    "^npx\\s+shadcn@latest\\s+(add|init)(\\s+[\\w@/-]+)*(\\s+--yes)?(\\s+2>&1)?$",
    "^npx\\s+tsx\\s+[^|;&]+$",
    "^npx\\s+next\\s+(build|dev|start|lint)(\\s+.*)?$",
    "^npx\\s+(--yes\\s+)?drizzle-kit\\s+(generate|push|studio)(\\s+--[\\w-]+(\\s+[\\w._-]+)*)*(\\s*2>&1)?$",
    "^npx\\s+(--yes\\s+)?semantic-release\\s+--dry-run[^|;&]*$",
    "^(PORT=\\d+\\s+)?npx\\s+playwright\\s+(test|install)\\b",

    "^pytest(\\s+.*)?$",
    "^python(3)?\\s+-m\\s+pytest(\\s+.*)?$",
    "^uv\\s+run\\s+(pytest|python|ruff|mypy)(\\s+.*)?$",
    "^ruff\\s+(check|format)(\\s+.*)?$",
    "^mypy(\\s+.*)?$",
    "^black\\s+--check(\\s+.*)?$",
    "^isort\\s+--check(\\s+.*)?$",
    "^pip\\s+(list|show|freeze)$",
    "^uv\\s+(pip\\s+list|pip\\s+show|sync|lock)(\\s+.*)?$",

    "^cargo\\s+(check|test|clippy|fmt\\s+--check|build)(\\s+.*)?$",
    "^go\\s+(test|vet|fmt|build)(\\s+.*)?$",

    "^(jq|grep|rg|fd|ag|awk|cut|tr|diff|comm)\\s+[^|;&]+$",
    "^find\\s+(?!.*-exec)[^|;&]+$",
    "^sed\\s+-n\\s+[^|;&]+$",
    "^(sort|uniq)(\\s+.*)?$",

    "^(sips|identify)\\s+[^|;&]+$",

    "^curl\\s+.*--head",
    "^curl\\s+-I\\s+",
    "^ping\\s+-c\\s+\\d+\\s+",
    "^(dig|nslookup|host)\\s+",

    "^mkdir(\\s+.*)?$",
    "^touch\\s+[^|;&]+$",
    "^(cp|mv)\\s+[^|;&]+$",
    "^rmdir\\s+[^|;&]+$",
    "^rm\\s+(?!.*(-r\\b|-rf\\b|-fr\\b|--recursive))[\\w.@-]+(\\s+[\\w.@-]+)*$",

    "^(npx\\s+)?vercel\\s+(ls|list|inspect|logs|whoami|env\\s+ls|project|--version|deployments)(\\s+[^|;&]*)?$",

    "^gh\\s+(pr|issue|repo|release|workflow|run|api|auth)(\\s+.*)?$",
    "^npm\\s+update\\s+[@\\w/-]+$",

    "^sleep\\s+[0-9.]+$",

    "^chmod\\s+[0-6][0-7][0-7]\\s+[^|;&]+$",

    "^lsof\\s+(-[a-zA-Z]+\\s+)*-?i\\s*[:\\d]+",
    "^lsof\\s+-ti:\\d+(\\s+2>/dev/null)?$",
    "^npm\\s+run\\s+clean(\\s+.*)?$",
    "^npm\\s+(dedupe|cache\\s+clean)(\\s+.*)?$",

    "^curl\\s+(-[a-zA-Z]+\\s+)*https?://localhost[:/][^|;&]*(\\s*2>&1)?(\\s*2>/dev/null)?$",
    "^curl\\s+-X\\s+(POST|GET|PUT|DELETE)\\s+['\"]?https?://localhost[:/][^|;&]*$",
    "^curl\\s+-s\\s+-o\\s+/dev/null\\s+-w\\s+[^|;&]*https?://localhost[^|;&]*$",
    "^curl\\s+-s\\s+-o\\s+/dev/null\\s+-w\\s+[^|;&]*https?://[^|;&]*$",

    "^pgrep\\s+[^|;&]+$",
    "^ps\\s+aux.*$",

    "^npm\\s+run\\s+dev(\\s+--\\s+-p\\s+\\d+)?\\s*(>\\s*(/tmp/[^|;&]+|/dev/null)\\s+)?2>&1\\s*&$",

    "^test\\s+-[dfeL]\\s+[^|;&]+$",

    "^xxd\\s+[^|;&]+$"
  ],

  "deny_patterns": [
    "^sudo\\b",
    "^doas\\b",
    "(?<!git\\s)\\brm\\s+.*(-r|-rf|-fr|--recursive)",
    "(?<!git\\s)\\brm\\s+-[^\\s]*r",
    "^rm\\s+/$",
    "^rm\\s+/(etc|usr|var|bin|sbin|lib|boot|dev|proc|sys|root|home)\\b",
    "\\bmkfs\\.",
    "\\bdd\\b.*\\bof=",
    "\\bshutdown\\b",
    "\\breboot\\b",
    "\\bsystemctl\\s+(start|stop|restart|enable|disable)",
    "\\bchmod\\s+777",
    "\\bchown\\s+.*:.*\\s+/",
    ">\\s*/etc/",
    ">\\s*~/\\.",
    "\\bcurl\\b.*\\|.*\\b(bash|sh|zsh)\\b",
    "\\bwget\\b.*\\|.*\\b(bash|sh|zsh)\\b",
    "\\beval\\s+.*\\$\\(",
    ":(){ :|:& };:",
    "\\bfork\\s*bomb",
    "\\bkill\\s+-9\\s+-1",
    "\\bpkill\\s+-9",
    "\\bkillall\\b",
    "\\bxargs\\b.*\\brm\\b",
    "\\b(nc|ncat|netcat)\\b",
    "\\bcrontab\\s+-[er]"
  ],

  "sensitive_paths": [
    "\\.env(?!\\.example)$",
    "\\.env\\.(?!example)",
    "\\.pem$",
    "\\.key$",
    "\\.crt$",
    "\\.p12$",
    "\\.pfx$",
    "id_rsa",
    "id_ed25519",
    "id_ecdsa",
    "\\.ssh/",
    "\\.gnupg/",
    "\\.git/config$",
    "\\.gitconfig$",
    "credentials",
    "\\.aws/",
    "\\.gcloud/",
    "\\.azure/",
    "\\.npmrc$",
    "\\.pypirc$",
    "\\.netrc$",
    "\\bsecrets?\\b",
    "\\bpassw(?:ord)?s?\\.(txt|json|env|yaml|yml|ini|conf|cfg)$",
    "\\btokens?\\.(txt|env|yaml|yml|ini|conf|cfg)$",
    "\\.docker/config\\.json",
    "\\.kube/config"
  ]
}
