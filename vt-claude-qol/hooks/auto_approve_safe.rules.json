{
  "allow_patterns": [
    "^(pwd|whoami|date)$",
    "^uname(\\s+-a)?$",
    "^which\\s+\\S+$",
    "^echo\\s+",

    "^(cat|head|tail|wc|less|file|stat|du|df)\\s+",
    "^ls(\\s+.*)?$",
    "^tree(\\s+.*)?$",

    "^(python(3)?|node|npm|pnpm|yarn|uv)\\s+--version$",

    "^git\\s+-C\\s+[^|;&]+\\s+(status|diff|log|show|branch|add|commit|checkout|fetch|pull|push)(\\s+.*)?$",
    "^git\\s+(status|diff|log|show|branch|remote|add|commit|checkout|fetch|pull|push|worktree|merge|rebase|tag|switch|restore|rev-parse|ls-files|check-ignore|update-index|stash\\s+(list|push|pop|drop|apply))(\\s+.*)?$",
    "^git\\s+rm\\s+[^|;&]+$",
    "^git\\s+rev-list\\s+[^|;&]+$",
    "^git\\s+stash(\\s+--include-untracked|\\s+--all|\\s+-u|\\s+-a)?(\\s+-m\\s+.*)?$",

    "^pnpm\\s+(test|run\\s+(test|lint|typecheck|type-check|check|build|dev|start)|install|i|add|remove)(\\s+.*)?$",
    "^npm\\s+(test|run\\s+(test|lint|lint:fix|typecheck|type-check|check|check-types|build|dev|dev:next|start)|install|i|ci)(\\s+.*)?$",
    "^npm\\s+whoami$",
    "^npm\\s+list(\\s+(-g|--global))?(\\s+[\\w@/-]+)?$",
    "^npm\\s+ls(\\s+[\\w@/-]+)*$",
    "^npm\\s+view\\s+[\\w@/-]+(\\s+.*)?$",
    "^npm\\s+pack\\s+[\\w@/-]+\\s+--dry-run",
    "^yarn\\s+(test|lint|typecheck|type-check|check|build|dev|start|install|add|remove)(\\s+.*)?$",
    "^npx\\s+(tsc|eslint|prettier|vitest|jest)(\\s+.*)?$",
    "^npx\\s+tsx\\s+[^|;&]+$",
    "^npx\\s+shadcn@latest\\s+(add|init)(\\s+[\\w@/-]+)*(\\s+--yes)?$",

    "^pytest(\\s+.*)?$",
    "^python(3)?\\s+-m\\s+pytest(\\s+.*)?$",
    "^uv\\s+run\\s+(pytest|python|ruff|mypy)(\\s+.*)?$",
    "^ruff\\s+(check|format)(\\s+.*)?$",
    "^mypy(\\s+.*)?$",
    "^black\\s+--check(\\s+.*)?$",
    "^isort\\s+--check(\\s+.*)?$",
    "^pip\\s+(list|show|freeze)$",
    "^uv\\s+(pip\\s+list|pip\\s+show|sync|lock)(\\s+.*)?$",

    "^cargo\\s+(check|test|clippy|fmt\\s+--check|build)(\\s+.*)?$",
    "^go\\s+(test|vet|fmt|build)(\\s+.*)?$",

    "^(jq|grep|rg|find|fd|ag|awk|cut|tr|diff|comm)\\s+",
    "^sed\\s+-n\\s+",
    "^(sort|uniq)(\\s+.*)?$",

    "^curl\\s+.*--head",
    "^curl\\s+-I\\s+",
    "^ping\\s+-c\\s+\\d+\\s+",
    "^(dig|nslookup|host)\\s+",

    "^mkdir(\\s+.*)?$",
    "^touch\\s+",
    "^(cp|mv)\\s+",
    "^rmdir\\s+[^|;&]+$",

    "^gh\\s+(pr|issue|repo|release|workflow|run|api|auth)(\\s+.*)?$",
    "^npm\\s+update\\s+[@\\w/-]+$",

    "^sleep\\s+\\d+$",

    "^chmod\\s+[0-6][0-7][0-7]\\s+",

    "^lsof\\s+(-[a-zA-Z]+\\s+)*-?i\\s*[:\\d]+",
    "^npm\\s+run\\s+clean(\\s+.*)?$",
    "^npm\\s+(dedupe|cache\\s+clean)(\\s+.*)?$",
    "^curl\\s+(-[sIo]+\\s+)*https?://localhost[:/][^|;&]*$",
    "^curl\\s+[^|;&]*http://localhost[:/][^|;&]*$",
    "^pgrep\\s+",

    "^curl\\s+(-[sXo]+\\s+)*(POST|GET|PUT|DELETE)\\s+['\"]?https?://localhost[:/][^|;&]*$",
    "^curl\\s+-s\\s+-o\\s+/dev/null\\s+-w\\s+[^|;&]*https?://localhost[^|;&]*$",

    "^npm\\s+run\\s+dev\\s*>\\s*/tmp/[^|;&]+\\s*2>&1\\s*&$",
    "^npm\\s+run\\s+dev\\s+--\\s+-p\\s+\\d+\\s*(&|2>&1\\s*&)$",
    "^npm\\s+run\\s+dev\\s*>\\s*/dev/null\\s+2>&1\\s*&$"
  ],

  "deny_patterns": [
    "^sudo\\b",
    "^doas\\b",
    "(?<!git\\s)\\brm\\s+.*(-r|-rf|-fr|--recursive)",
    "(?<!git\\s)\\brm\\s+-[^\\s]*r",
    "^rm\\s+/",
    "\\bmkfs\\.",
    "\\bdd\\b.*\\bof=",
    "\\bshutdown\\b",
    "\\breboot\\b",
    "\\bsystemctl\\s+(start|stop|restart|enable|disable)",
    "\\bchmod\\s+777",
    "\\bchown\\s+.*:.*\\s+/",
    ">\\s*/etc/",
    ">\\s*~/\\.",
    "\\bcurl\\b.*\\|.*\\b(bash|sh|zsh)\\b",
    "\\bwget\\b.*\\|.*\\b(bash|sh|zsh)\\b",
    "\\beval\\s+.*\\$\\(",
    ":(){ :|:& };:",
    "\\bfork\\s*bomb",
    "\\bkill\\s+-9\\s+-1",
    "\\bpkill\\s+-9",
    "\\bkillall\\b"
  ],

  "sensitive_paths": [
    "\\.env$",
    "\\.env\\.(?!example)",
    "\\.env\\.",
    "\\.pem$",
    "\\.key$",
    "\\.crt$",
    "\\.p12$",
    "\\.pfx$",
    "id_rsa",
    "id_ed25519",
    "id_ecdsa",
    "\\.ssh/",
    "\\.gnupg/",
    "\\.git/config$",
    "\\.gitconfig$",
    "credentials",
    "\\.aws/",
    "\\.gcloud/",
    "\\.azure/",
    "\\.npmrc$",
    "\\.pypirc$",
    "\\.netrc$",
    "\\bsecrets?\\b",
    "\\bpassw(?:ord)?s?\\.(txt|json|env|yaml|yml|ini|conf|cfg)$",
    "\\btoken"
  ]
}
